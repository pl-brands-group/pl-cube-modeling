cubes:
  # 聚水潭采购订单汇总表
  - name: ads_purchase_query_sum_clean
    sql: |
      SELECT *
      FROM Jushuitan.ads_purchaseQuerySum_clean
    data_source: default

    dimensions:
      - name: po_id
        sql: po_id
        type: number
        primary_key: true

      - name: seller
        sql: seller
        type: string
        description: 供应商名称

      - name: seller_shorted
        sql: seller_shorted
        type: string
        description: 供应商简称/编码

      - name: status
        sql: status
        type: string
        description: 订单状态

      - name: po_date
        sql: po_date
        type: time
        description: 采购日期

      - name: finish_time
        sql: finish_time
        type: time
        description: 完成日期

      - name: is_finished
        sql: is_finished
        type: string
        description: 是否完成

    measures:
      - name: count
        type: count

      # 采购数量
      - name: sum_qty
        sql: sum_qty
        type: sum

      # 已入库数量
      - name: sum_inqty
        sql: sum_inqty
        type: sum

      # 未入库数量
      - name: unreceived_qty
        sql: unreceived_qty
        type: sum

      # 完成率
      - name: completion_rate
        sql: completion_rate
        type: avg

      # 采购金额
      - name: sum_price
        sql: sum_price
        type: sum

      # 总延期扣款
      - name: total_delay_cost
        sql: total_delay_cost
        type: sum

      # 利润额度
      - name: profit_limit
        sql: profit_limit
        type: sum

      # 已入库延期费用
      - name: received_delay_cost
        sql: received_delay_cost
        type: sum

      # 未入库延期费用
      - name: unreceived_delay_cost
        sql: unreceived_delay_cost
        type: sum
